<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>BOLETIM MÁGICO</title>
  <link href="https://fonts.googleapis.com/css2?family=Reenie+Beanie&family=Caveat:wght@600&family=Patrick+Hand&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    :root{
      --c:#f4f4f4;--g:#a8e6cf;--y:#fff9b1;--gold:#ffd700;--ok:#50c878;--no:#ff4500;
      --bg-login: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
    }
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%;overflow:auto;-webkit-overflow-scrolling:touch;background:var(--bg-login);font-family:'Patrick Hand',cursive;color:var(--c)}
    
    /* FUNDO E BORDA DO LOGIN EM TODA A PÁGINA */
    .app-wrapper{
      min-height:100vh;
      background:var(--bg-login);
      padding:15px;
      display:flex;
      justify-content:center;
    }
    .container{
      max-width:1350px;
      width:100%;
      background:#141428ee;
      border-radius:40px;
      border:8px solid var(--gold);
      box-shadow:0 0 90px #ffd70099, inset 0 0 60px #ffd70033;
      overflow:hidden;
      display:none;
    }

    header{background:linear-gradient(135deg,#2d5a2d,#1a3d1a);padding:30px 20px;text-align:center;border-bottom:12px double var(--g)}
    h1{font-family:'Caveat',cursive;font-size:4.5rem;color:var(--y);text-shadow:6px 6px 18px #000}

    .niveis{display:flex;justify-content:center;gap:20px;flex-wrap:wrap;margin:25px}
    .nb{background:#4a90e2;color:#fff;padding:20px 35px;border-radius:35px;font-family:'Caveat',cursive;font-size:2.2rem;border:6px solid var(--gold);cursor:pointer;transition:.4s}
    .nb:hover{transform:translateY(-8px) scale(1.05)}
    .nb.active{background:var(--gold);color:#000;border-color:#ff4500}

    .anos{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:15px;margin:30px 20px;padding:20px;background:#0003;border-radius:28px;border:5px dashed var(--g)}
    .ab{background:#142314ee;color:var(--c);padding:15px;font-size:1.6rem;border:5px solid var(--g);border-radius:20px;cursor:pointer;transition:.3s;text-align:center}
    .ab:hover{background:var(--g);color:#000}
    .ab.active{background:var(--y);color:#000;border-color:#ff4500}

    .turma-atual{text-align:center;font-size:3.2rem;color:var(--y);font-family:'Caveat',cursive;margin:15px}
    .turma-nav{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin:15px}
    .tb{background:#142314ee;color:var(--c);padding:10px 20px;border-radius:22px;font-size:1.5rem;border:4px solid var(--g);cursor:pointer;transition:.3s}
    .tb:hover{background:var(--g);color:#000}
    .tb.active{background:var(--y);color:#000;border-color:#ff4500}

    .form{background:#142314cc;padding:30px;border-radius:35px;margin:25px;border:6px dashed var(--g);backdrop-filter:blur(12px)}
    .row{display:flex;gap:20px;flex-wrap:wrap;margin-bottom:20px}
    .ig{flex:1;min-width:200px}
    label{display:block;margin-bottom:10px;color:var(--g);font-size:1.4rem;font-weight:700}
    input{width:100%;padding:15px;border:5px solid var(--g);border-radius:20px;background:#fff2;color:#fff;font-size:1.3rem;text-align:center}
    input:focus{outline:none;border-color:var(--y);box-shadow:0 0 0 8px #ffeb3b44}

    .botoes{display:flex;gap:20px;justify-content:center;margin-top:30px;flex-wrap:wrap}
    .btn{background:var(--g);color:#000;padding:18px 40px;border:none;border-radius:22px;font-size:1.6rem;font-weight:700;cursor:pointer;font-family:'Caveat',cursive;transition:.3s}
    .btn:hover{background:#90ee90;transform:translateY(-7px) scale(1.06)}
    .surpresa{background:linear-gradient(45deg,var(--gold),#ff8c00);color:#000;font-size:2.1rem;padding:25px 55px;border:8px solid #ff4500;animation:p 1.8s infinite;box-shadow:0 0 60px #ffd700aa}
    @keyframes p{0%,100%{transform:scale(1)}50%{transform:scale(1.12)}}

    .lista{margin:25px;padding:20px;background:#142314cc;border-radius:35px;border:6px dashed var(--g);min-height:150px}
    .card{background:#0f1f0fcc;padding:25px;border-radius:28px;margin:15px 0;border:5px solid var(--g);box-shadow:0 12px 35px #0008;position:relative;overflow:hidden;transition:all .6s}
    .nome-hover{cursor:crosshair;position:relative;user-select:none;-webkit-user-select:none}
    .nome-hover::after{content:"TOQUE LONGO ou ←";position:absolute;bottom:-32px;left:50%;transform:translateX(-50%);background:#ff69b4;color:#000;padding:7px 14px;border-radius:15px;font-size:0.9rem;opacity:0;transition:.4s;white-space:nowrap;z-index:10}
    .nome-hover:hover::after,.nome-hover.touch::after{opacity:1;bottom:-42px}
    .nome-hover:hover,.nome-hover.touch{transform:scale(1.1);text-shadow:0 0 20px #ffd700}

    .notas{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;margin:15px 0}
    .nbx{text-align:center;background:#fff1;padding:15px;border-radius:16px;border:4px solid var(--g)}
    .nbx h4{color:#ffb3ba;margin-bottom:8px;font-size:1.2rem}

    .poof{font-size:3.5rem;font-weight:900;color:#ff69b4;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);pointer-events:none;animation:poof 1s forwards}
    @keyframes poof{0%{opacity:1;transform:translate(-50%,-50%) scale(0)}50%{opacity:1;transform:translate(-50%,-50%) scale(1.5)}100%{opacity:0;transform:translate(-50%,-50%) scale(2)}}
    .smoke{position:absolute;width:100%;height:100%;background:radial-gradient(circle,#fff3 20%,transparent 70%);pointer-events:none;animation:smoke 1.2s forwards}
    @keyframes smoke{0%{opacity:0.8;transform:scale(0)}100%{opacity:0;transform:scale(3)}}

    .surpresa-master{display:none;padding:35px 0;background:#142314ee;border-radius:35px;margin:25px;border:8px solid var(--gold)}
    .secao{margin:40px 20px;background:linear-gradient(135deg,#142314,#0a1a0a);border:8px solid var(--gold);border-radius:40px;padding:40px;box-shadow:0 25px 70px #000b,inset 0 0 60px #ffd70044}
    .titulo-secao{text-align:center;font-size:3.8rem;color:var(--y);margin-bottom:30px;text-shadow:0 0 30px var(--gold);font-family:'Caveat',cursive}
    .duas-listas{display:grid;grid-template-columns:1fr;gap:30px}
    .lista-ok,.lista-no{background:#50c87833;border:6px dashed var(--ok);border-radius:30px;padding:25px}
    .lista-no{background:#ff450033;border:6px dashed var(--no)}
    .lista-tit{font-size:2.5rem;text-align:center;margin-bottom:20px;color:var(--ok);text-shadow:0 0 20px var(--ok)}
    .no-tit{color:var(--no);text-shadow:0 0 20px var(--no)}
    .aluno-item{background:#142314ee;padding:18px;border-radius:20px;margin:12px 0;display:flex;justify-content:space-between;align-items:center;box-shadow:0 8px 25px #0007}
    .aluno-nome{font-family:'Reenie Beanie',cursive;font-size:2.1rem;color:var(--y)}
    .aluno-media{font-size:2rem;font-weight:900;color:var(--gold)}
    .rank-list{display:grid;gap:20px;margin-top:25px}
    .ritem{display:flex;align-items:center;background:#142314ee;padding:22px;border-radius:28px;border:3px solid transparent;transition:.4s}
    .ritem:hover{transform:translateX(10px) scale(1.04);border-color:var(--y)}
    .rpos{width:65px;height:65px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:900;margin-right:20px;box-shadow:0 0 40px #000a}
    .p1{background:var(--gold);color:#000}.p2{background:#c0c0c0;color:#000}.p3{background:#cd7f32;color:#000}
    .rname{flex:1;font-family:'Reenie Beanie',cursive;font-size:2.3rem;color:var(--y)}
    .rmed{font-size:1.8rem;font-weight:700;color:var(--gold)}
    .trof{position:relative;width:120px;height:120px;margin:0 auto 20px;opacity:0;animation:t 1.7s forwards}
    @keyframes t{0%{opacity:0;transform:translateY(-100px) scale(.5)}70%{opacity:1;transform:translateY(20px) scale(1.2)}100%{opacity:1}}
    .cup{width:100%;height:100%;background:linear-gradient(135deg,#ffeb3b,#ffb300);border-radius:50%/60% 60% 40% 40%;box-shadow:0 0 60px var(--gold);animation:g 4s linear infinite}
    @keyframes g{to{transform:rotateY(360deg)}}
    .write{display:inline-block;overflow:hidden;white-space:nowrap;font-family:'Reenie Beanie',cursive;font-size:2.1rem;position:relative}
    .write::after{content:'';position:absolute;right:0;width:5px;height:100%;background:var(--g);animation:bl 1s steps(2) infinite}
    @keyframes bl{50%{opacity:0}}

    /* LOGIN COM MESMO ESTILO */
    #login{
      position:fixed;inset:0;
      background:var(--bg-login);
      display:flex;align-items:center;justify-content:center;
      z-index:9999;padding:20px;
    }
    .logbox{
      background:#141428ee;
      padding:60px 40px;
      border-radius:40px;
      border:8px solid var(--gold);
      box-shadow:0 0 90px #ffd70099;
      text-align:center;
      width:90%;
      max-width:480px;
    }
    #login input{width:100%;padding:20px;border-radius:25px;border:6px solid var(--gold);background:#fff1;color:#fff;font-size:1.5rem;text-align:center;margin:20px 0}
    #entrar{background:var(--gold);color:#000;padding:20px 50px;border:none;border-radius:25px;font-size:1.8rem;font-weight:700;cursor:pointer}
    #entrar:hover{transform:scale(1.06)}
    .dica{color:#ff69b4;cursor:pointer;margin-top:15px;font-size:1.1rem}

    @media(min-width:768px){
      .duas-listas{grid-template-columns:1fr 1fr}
      h1{font-size:5rem}
      .nb{font-size:2.5rem;padding:28px 50px}
      .surpresa{font-size:2.3rem;padding:28px 60px}
    }
  </style>
</head>
<body>

  <!-- LOGIN -->
  <div id="login">
    <div class="logbox">
      <h1>BOLETIM MÁGICO</h1>
      <p>Varinha na mão, Mestre?</p>
      <input type="password" id="senha" placeholder="Senha mágica...">
      <button id="entrar">ENTRE MESTRE</button>
      <p class="dica" onclick="alert('Dica: começa com M maiúsculo!')">Esqueci a varinha...</p>
    </div>
  </div>

  <!-- SITE DENTRO DO WRAPPER -->
  <div class="app-wrapper">
    <div class="container">
      <header><h1>BOLETIM MÁGICO</h1></header>
      <div class="niveis">
        <button class="nb active" data-n="f1">Fundamental I</button>
        <button class="nb" data-n="f2">Fundamental II</button>
        <button class="nb" data-n="m">Ensino Médio</button>
      </div>
      <div id="anosBox" class="anos"></div>
      <div class="turma-atual" id="turmaAtual">Selecione um ano</div>
      <div class="turma-nav" id="turmaNav"></div>

      <div class="form">
        <div class="row"><div class="ig"><label>Nome do Aluno</label><input id="nome"></div></div>
        <div class="row"><div class="ig"><label>Matéria</label><input id="materia" placeholder="Ex: Poções"></div></div>
        <div class="row">
          <div class="ig"><label>1º Tri</label><input type="number" id="n1" step="0.1" min="0" max="10"></div>
          <div class="ig"><label>2º Tri</label><input type="number" id="n2" step="0.1" min="0" max="10"></div>
          <div class="ig"><label>3º Tri</label><input type="number" id="n3" step="0.1" min="0" max="10"></div>
        </div>
        <div class="botoes">
          <button class="btn" onclick="adicionar()">ADICIONAR</button>
          <button class="surpresa" onclick="surpresa()">SURPRESA!</button>
        </div>
      </div>

      <div id="lista" class="lista"></div>

      <div id="surpresaMaster" class="surpresa-master">
        <div class="secao">
          <h2 class="titulo-secao">LISTA OFICIAL</h2>
          <div class="duas-listas">
            <div class="lista-ok"><div class="lista-tit ok-tit">APROVADOS</div><div id="aprovados"></div></div>
            <div class="lista-no"><div class="lista-tit no-tit">REPROVADOS</div><div id="reprovados"></div></div>
          </div>
        </div>
        <div class="secao">
          <h2 class="titulo-secao">RANKING DA TURMA</h2>
          <div id="rankLista" class="rank-list"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const SENHA="Magia";
    const harry=new Audio('https://cdn.glitch.global/7b7d7d7d-7d7d-7d7d-7d7d-7d7d7d7d7d7d/Hedwigs-Theme-30s.mp3'); harry.volume=.6;
    const alo=new Audio('https://www.soundjay.com/misc/sounds/magic-chime-02.mp3');
    const win=new Audio('https://www.soundjay.com/misc/sounds/bell-ring-01.mp3');
    const poofSound=new Audio('https://cdn.glitch.global/c4c4c4c4-c4c4-4c4c-8c4c-c4c4c4c4c4c4/magic-poof.mp3');
    let db=JSON.parse(localStorage.getItem('boletim2025'))||{};
    let nivel='f2', ano=null, turma=null, campeao=null, trof=null, alunoHover=null, touchTimer=null;
    const anos={f1:["1° Ano","2° Ano","3° Ano","4° Ano","5° Ano"],f2:["6° Ano","7° Ano","8° Ano","9° Ano"],m:["1° Médio","2° Médio","3° Médio"]};

    document.getElementById('entrar').onclick=()=>{
      if(document.getElementById('senha').value===SENHA){
        alo.play(); harry.play();
        falar("BEM-VINDO AO BOLETIM MÁGICO! Toque longo ou BACKSPACE para POOF!");
        document.getElementById('login').style='opacity:0;transform:scale(.8);transition:1.3s';
        setTimeout(()=>{document.getElementById('login').remove();document.querySelector('.container').style.display='block';confete();carregaNivel('f2');},1300);
      }else alert('Senha errada!');
    };

    document.querySelectorAll('.nb').forEach(b=>b.onclick=()=>{document.querySelectorAll('.nb').forEach(x=>x.classList.remove('active'));b.classList.add('active');carregaNivel(b.dataset.n);});
    function carregaNivel(n){nivel=n;const box=document.getElementById('anosBox');box.innerHTML='';anos[n].forEach(a=>{const btn=document.createElement('button');btn.className='ab';btn.textContent=a;btn.onclick=()=>selecionaAno(a);box.appendChild(btn);});ano=null;turma=null;atualiza();}
    function selecionaAno(a){ano=a;document.querySelectorAll('.ab').forEach(b=>b.classList.remove('active'));event.target.classList.add('active');document.getElementById('turmaAtual').textContent=ano;const nav=document.getElementById('turmaNav');nav.innerHTML='';['A','B','C','D'].forEach(l=>{const btn=document.createElement('button');btn.className='tb';btn.textContent=l;btn.onclick=()=>selecionaTurma(l);nav.appendChild(btn);});selecionaTurma('A');}
    function selecionaTurma(l){turma=`${ano} ${l}`;document.querySelectorAll('.tb').forEach(b=>b.classList.remove('active'));event.target.classList.add('active');document.getElementById('turmaAtual').textContent=turma;atualiza();}

    function adicionar(){
      const nome=document.getElementById('nome').value.trim();
      let materia=document.getElementById('materia').value.trim()||"Matéria Geral";
      const n1=+document.getElementById('n1').value||0;
      const n2=+document.getElementById('n2').value||0;
      const n3=+document.getElementById('n3').value||0;
      if(!nome)return alert('Nome obrigatório!');
      if([n1,n2,n3].some(x=>x<0||x>10))return alert('Notas 0 a 10!');
      const media=((n1+n2+n3)/3).toFixed(2);
      if(!db[turma])db[turma]=[];
      db[turma].push({nome,materia,n1,n2,n3,media:+media,ok:media>=6});
      localStorage.setItem('boletim2025',JSON.stringify(db));
      limpar();atualiza();
      falar(`${nome} entrou com média ${media}!`);
      confete();
    }
    function limpar(){document.getElementById('nome').value='';document.getElementById('materia').value='';['n1','n2','n3'].forEach(id=>document.getElementById(id).value='');}

    function atualiza(){
      if(!turma){document.getElementById('lista').innerHTML='<div style="text-align:center;color:#88bb88;padding:60px;font-size:1.6rem">Selecione turma</div>';return;}
      const alunos=db[turma]||[];
      const lista=document.getElementById('lista');
      lista.innerHTML=alunos.length?'':'<div style="text-align:center;color:#88bb88;padding:60px;font-size:1.6rem">Nenhum aluno</div>';
      alunos.forEach((a,i)=>{
        const card=document.createElement('div');card.className='card';
        card.innerHTML=`
          <div class="nome-hover" data-i="${i}">
            <div class="write" data-text="${a.nome}"></div>
          </div>
          <div style="font-size:1.5rem;color:#ffb3ba;text-align:center;margin:8px 0">${a.materia}</div>
          <div class="notas">
            <div class="nbx"><h4>1º Tri</h4><p class="write" data-text="${a.n1.toFixed(1)}"></p></div>
            <div class="nbx"><h4>2º Tri</h4><p class="write" data-text="${a.n2.toFixed(1)}"></p></div>
            <div class="nbx"><h4>3º Tri</h4><p class="write" data-text="${a.n3.toFixed(1)}"></p></div>
          </div>
          <div style="text-align:center;margin-top:12px;font-size:1.5rem;color:#ffd700">Média: <b>${a.media}</b></div>`;
        lista.appendChild(card);
      });
      escreve(lista);
      ativarPoof();
      document.getElementById('surpresaMaster').style.display='none';
    }

    function ativarPoof(){
      document.querySelectorAll('.nome-hover').forEach(el=>{
        el.onmouseover=()=>alunoHover=el;
        el.onmouseout=()=>alunoHover=null;
        el.ontouchstart=e=>{e.preventDefault();el.classList.add('touch');touchTimer=setTimeout(()=>poof(el),800);};
        el.ontouchend=e=>{e.preventDefault();clearTimeout(touchTimer);el.classList.remove('touch');};
      });
    }
    document.addEventListener('keydown',e=>{if(e.key==='Backspace'&&alunoHover){e.preventDefault();poof(alunoHover);}});
    function poof(el){
      const i=el.dataset.i;
      if(!confirm('Expelliarmus! Apagar aluno?'))return;
      poofSound.play();
      const card=el.parentElement;
      card.innerHTML+=`<div class="poof">POOF!</div><div class="smoke"></div>`;
      card.style.transform='scale(0) rotate(720deg)';card.style.opacity='0';
      setTimeout(()=>{
        db[turma].splice(i,1);
        localStorage.setItem('boletim2025',JSON.stringify(db));
        card.remove();
        falar('POOF! Aluno apagado!');
        confete();
        if(!db[turma].length)document.getElementById('lista').innerHTML='<div style="text-align:center;color:#88bb88;padding:60px;font-size:1.6rem">Nenhum aluno</div>';
      },800);
    }

    function surpresa(){
      if(!db[turma]||!db[turma].length)return alert('Adicione alunos primeiro!');
      const master=document.getElementById('surpresaMaster');master.style.display='block';
      const ok=document.getElementById('aprovados');ok.innerHTML='';
      const no=document.getElementById('reprovados');no.innerHTML='';
      const rank=document.getElementById('rankLista');rank.innerHTML='';
      const ordenado=[...db[turma]].sort((a,b)=>b.media-a.media);
      let delay=800;
      ordenado.forEach(a=>{
        const item=document.createElement('div');item.className='aluno-item';
        item.innerHTML=`<div class="aluno-nome write" data-text="${a.nome} (${a.materia})"></div><div class="aluno-media">${a.media}</div>`;
        (a.ok?ok:no).appendChild(item);
        setTimeout(()=>falar(`${a.nome} ${a.ok?'APROVADO':'REPROVADO'} com ${a.media}!`),delay);
        delay+=1200;
      });
      escreve(ok);escreve(no);
      if(ordenado[0].nome!==campeao){
        campeao=ordenado[0].nome;
        setTimeout(()=>{win.play();falar(`CAMPEÃO: ${campeao} com ${ordenado[0].media}!`);confete();trofeu();},700);
      }
      ordenado.forEach((a,i)=>{
        const pos=i===0?'p1':i===1?'p2':i===2?'p3':'';
        const item=document.createElement('div');item.className='ritem';
        item.innerHTML=`<div class="rpos ${pos}">${i+1}º</div><div class="rname write" data-text="${a.nome} (${a.materia})"></div><div class="rmed">${a.media}</div>`;
        rank.appendChild(item);
      });
      escreve(rank);
      master.scrollIntoView({behavior:'smooth'});
    }
    function trofeu(){if(trof)trof.remove();trof=document.createElement('div');trof.className='trof';trof.innerHTML='<div class="cup"></div>';document.getElementById('rankLista').prepend(trof);}

    function escreve(el){el.querySelectorAll('.write').forEach((e,i)=>{const txt=e.dataset.text;e.textContent='';let j=0;const int=setInterval(()=>{if(j<=txt.length){e.textContent=txt.slice(0,j);j++;}else{clearInterval(int);e.style.borderRight='none';}},70+i*30);});}
    function falar(t){if('speechSynthesis' in window){const u=new SpeechSynthesisUtterance(t);u.lang='pt-BR';u.rate=0.9;u.pitch=1.2;u.volume=1;speechSynthesis.speak(u);}}
    function confete(){confetti({particleCount:500,spread:140,origin:{y:0.55},colors:['#50c878','#ffd700','#ff69b4','#87CEEB']});}
    carregaNivel('f2');
  </script>
  <a href="./jogo.html">jogo</a>
</body>
</html>
